
# SimuDICE

SimuDICE is a framework for Offline Policy Optimization through World Model Updates and Distribution Correction Estimation (DICE). It addresses challenges in offline reinforcement learning, particularly the distribution mismatch between the target policy and the behavioral policy used to collect data. SimuDICE iteratively refines the initial policy derived from offline data by generating synthetic experiences from a learned dynamic model of the environment.

## Prerequisites

To set up the environment and install the required dependencies, follow these steps:

1. **Create a virtual environment**:
   ```bash
   python3 -m venv venv
   ```
2. **Activate the virtual environment**:
   - On Linux/MacOS:
     ```bash
     source venv/bin/activate
     ```
   - On Windows:
     ```bash
     .env\Scriptsctivate
     ```
3. **Install the required packages**:
   ```bash
   pip install -r requirements.txt
   ```

## Running the Project

### Step 1: Generate the Dataset
Run the following command to generate the dataset using the specified environment (e.g., Taxi):
```bash
python3 dataset_generator.py --env Taxi --epsilon 0.1 --alpha 0.1 --gamma 0.99 --train_episodes 10000 --play_episodes 510 --max_environment_steps 100 --save_trajectories --debug
```

### Step 2: Run the Main Algorithm
Use the generated dataset to run the SimuDICE algorithm:
```bash
python3 main.py --env Taxi --data_path ./datasets/Taxi_0.1_10000_510_100_behavioral_data.pkl --alpha 0.1 --gamma 0.99 --planning_steps 20 --iterations 1 --lambda_value 100 --sampling_strategy 1 --play_episodes 500 --max_environment_steps 100 --max_episodes 100
```

## Description of the Commands

- `--env`: Specifies the environment to use, such as Taxi.
- `--epsilon`: Epsilon value for the epsilon-greedy policy.
- `--alpha`: Learning rate for the Q-learning update.
- `--gamma`: Discount factor for future rewards.
- `--train_episodes`: Number of episodes to train the policy.
- `--play_episodes`: Number of episodes to simulate for evaluation.
- `--max_environment_steps`: Maximum number of steps per episode.
- `--save_trajectories`: Option to save the trajectories.
- `--debug`: Enables debugging mode for detailed output.
- `--data_path`: Path to the dataset file generated by `dataset_generator.py`.
- `--planning_steps`: Number of planning steps used in SimuDICE.
- `--iterations`: Number of iterations for policy refinement.
- `--lambda_value`: Regularization parameter for sampling strategy.
- `--sampling_strategy`: Strategy for sampling synthetic experiences.
